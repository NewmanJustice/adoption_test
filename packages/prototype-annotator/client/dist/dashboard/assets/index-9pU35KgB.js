(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Q,k,ke,F,de,xe,Ee,Se,ie,ee,te,z={},Pe=[],He=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Y=Array.isArray;function D(t,e){for(var r in e)t[r]=e[r];return t}function ae(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ie(t,e,r){var a,i,o,c={};for(o in e)o=="key"?a=e[o]:o=="ref"?i=e[o]:c[o]=e[o];if(arguments.length>2&&(c.children=arguments.length>3?Q.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)c[o]===void 0&&(c[o]=t.defaultProps[o]);return V(t,c,a,i,null)}function V(t,e,r,a,i){var o={type:t,props:e,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++ke,__i:-1,__u:0};return i==null&&k.vnode!=null&&k.vnode(o),o}function U(t){return t.children}function J(t,e){this.props=t,this.context=e}function I(t,e){if(e==null)return t.__?I(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?I(t):null}function Ce(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return Ce(t)}}function _e(t){(!t.__d&&(t.__d=!0)&&F.push(t)&&!X.__r++||de!=k.debounceRendering)&&((de=k.debounceRendering)||xe)(X)}function X(){for(var t,e,r,a,i,o,c,d=1;F.length;)F.length>d&&F.sort(Ee),t=F.shift(),d=F.length,t.__d&&(r=void 0,a=void 0,i=(a=(e=t).__v).__e,o=[],c=[],e.__P&&((r=D({},a)).__v=a.__v+1,k.vnode&&k.vnode(r),se(e.__P,r,a,e.__n,e.__P.namespaceURI,32&a.__u?[i]:null,o,i??I(a),!!(32&a.__u),c),r.__v=a.__v,r.__.__k[r.__i]=r,Ae(o,r,c),a.__e=a.__=null,r.__e!=i&&Ce(r)));X.__r=0}function $e(t,e,r,a,i,o,c,d,f,l,_){var s,g,u,v,h,y,m,b=a&&a.__k||Pe,P=e.length;for(f=Re(r,e,b,f,P),s=0;s<P;s++)(u=r.__k[s])!=null&&(g=u.__i==-1?z:b[u.__i]||z,u.__i=s,y=se(t,u,g,i,o,c,d,f,l,_),v=u.__e,u.ref&&g.ref!=u.ref&&(g.ref&&le(g.ref,null,u),_.push(u.ref,u.__c||v,u)),h==null&&v!=null&&(h=v),(m=!!(4&u.__u))||g.__k===u.__k?f=Te(u,f,t,m):typeof u.type=="function"&&y!==void 0?f=y:v&&(f=v.nextSibling),u.__u&=-7);return r.__e=h,f}function Re(t,e,r,a,i){var o,c,d,f,l,_=r.length,s=_,g=0;for(t.__k=new Array(i),o=0;o<i;o++)(c=e[o])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=t.__k[o]=V(null,c,null,null,null):Y(c)?c=t.__k[o]=V(U,{children:c},null,null,null):c.constructor===void 0&&c.__b>0?c=t.__k[o]=V(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):t.__k[o]=c,f=o+g,c.__=t,c.__b=t.__b+1,d=null,(l=c.__i=je(c,r,f,s))!=-1&&(s--,(d=r[l])&&(d.__u|=2)),d==null||d.__v==null?(l==-1&&(i>_?g--:i<_&&g++),typeof c.type!="function"&&(c.__u|=4)):l!=f&&(l==f-1?g--:l==f+1?g++:(l>f?g--:g++,c.__u|=4))):t.__k[o]=null;if(s)for(o=0;o<_;o++)(d=r[o])!=null&&(2&d.__u)==0&&(d.__e==a&&(a=I(d)),Le(d,d));return a}function Te(t,e,r,a){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=Te(i[o],e,r,a));return e}t.__e!=e&&(a&&(e&&t.type&&!e.parentNode&&(e=I(t)),r.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function je(t,e,r,a){var i,o,c,d=t.key,f=t.type,l=e[r],_=l!=null&&(2&l.__u)==0;if(l===null&&d==null||_&&d==l.key&&f==l.type)return r;if(a>(_?1:0)){for(i=r-1,o=r+1;i>=0||o<e.length;)if((l=e[c=i>=0?i--:o++])!=null&&(2&l.__u)==0&&d==l.key&&f==l.type)return c}return-1}function he(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||He.test(e)?r:r+"px"}function G(t,e,r,a,i){var o,c;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof a=="string"&&(t.style.cssText=a=""),a)for(e in a)r&&e in r||he(t.style,e,"");if(r)for(e in r)a&&r[e]==a[e]||he(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(Se,"$1")),c=e.toLowerCase(),e=c in t||e=="onFocusOut"||e=="onFocusIn"?c.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=r,r?a?r.u=a.u:(r.u=ie,t.addEventListener(e,o?te:ee,o)):t.removeEventListener(e,o?te:ee,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function pe(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=ie++;else if(e.t<r.u)return;return r(k.event?k.event(e):e)}}}function se(t,e,r,a,i,o,c,d,f,l){var _,s,g,u,v,h,y,m,b,P,$,A,O,B,H,M,R,T=e.type;if(e.constructor!==void 0)return null;128&r.__u&&(f=!!(32&r.__u),o=[d=e.__e=r.__e]),(_=k.__b)&&_(e);e:if(typeof T=="function")try{if(m=e.props,b="prototype"in T&&T.prototype.render,P=(_=T.contextType)&&a[_.__c],$=_?P?P.props.value:_.__:a,r.__c?y=(s=e.__c=r.__c).__=s.__E:(b?e.__c=s=new T(m,$):(e.__c=s=new J(m,$),s.constructor=T,s.render=Ue),P&&P.sub(s),s.state||(s.state={}),s.__n=a,g=s.__d=!0,s.__h=[],s._sb=[]),b&&s.__s==null&&(s.__s=s.state),b&&T.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=D({},s.__s)),D(s.__s,T.getDerivedStateFromProps(m,s.__s))),u=s.props,v=s.state,s.__v=e,g)b&&T.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),b&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(b&&T.getDerivedStateFromProps==null&&m!==u&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(m,$),e.__v==r.__v||!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(m,s.__s,$)===!1){for(e.__v!=r.__v&&(s.props=m,s.state=s.__s,s.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(L){L&&(L.__=e)}),A=0;A<s._sb.length;A++)s.__h.push(s._sb[A]);s._sb=[],s.__h.length&&c.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(m,s.__s,$),b&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(u,v,h)})}if(s.context=$,s.props=m,s.__P=t,s.__e=!1,O=k.__r,B=0,b){for(s.state=s.__s,s.__d=!1,O&&O(e),_=s.render(s.props,s.state,s.context),H=0;H<s._sb.length;H++)s.__h.push(s._sb[H]);s._sb=[]}else do s.__d=!1,O&&O(e),_=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++B<25);s.state=s.__s,s.getChildContext!=null&&(a=D(D({},a),s.getChildContext())),b&&!g&&s.getSnapshotBeforeUpdate!=null&&(h=s.getSnapshotBeforeUpdate(u,v)),M=_,_!=null&&_.type===U&&_.key==null&&(M=De(_.props.children)),d=$e(t,Y(M)?M:[M],e,r,a,i,o,c,d,f,l),s.base=e.__e,e.__u&=-161,s.__h.length&&c.push(s),y&&(s.__E=s.__=null)}catch(L){if(e.__v=null,f||o!=null)if(L.then){for(e.__u|=f?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;o[o.indexOf(d)]=null,e.__e=d}else{for(R=o.length;R--;)ae(o[R]);ne(e)}else e.__e=r.__e,e.__k=r.__k,L.then||ne(e);k.__e(L,e,r)}else o==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):d=e.__e=ze(r.__e,e,r,a,i,o,c,f,l);return(_=k.diffed)&&_(e),128&e.__u?void 0:d}function ne(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ne)}function Ae(t,e,r){for(var a=0;a<r.length;a++)le(r[a],r[++a],r[++a]);k.__c&&k.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){k.__e(o,i.__v)}})}function De(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Y(t)?t.map(De):D({},t)}function ze(t,e,r,a,i,o,c,d,f){var l,_,s,g,u,v,h,y=r.props||z,m=e.props,b=e.type;if(b=="svg"?i="http://www.w3.org/2000/svg":b=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(l=0;l<o.length;l++)if((u=o[l])&&"setAttribute"in u==!!b&&(b?u.localName==b:u.nodeType==3)){t=u,o[l]=null;break}}if(t==null){if(b==null)return document.createTextNode(m);t=document.createElementNS(i,b,m.is&&m),d&&(k.__m&&k.__m(e,o),d=!1),o=null}if(b==null)y===m||d&&t.data==m||(t.data=m);else{if(o=o&&Q.call(t.childNodes),!d&&o!=null)for(y={},l=0;l<t.attributes.length;l++)y[(u=t.attributes[l]).name]=u.value;for(l in y)if(u=y[l],l!="children"){if(l=="dangerouslySetInnerHTML")s=u;else if(!(l in m)){if(l=="value"&&"defaultValue"in m||l=="checked"&&"defaultChecked"in m)continue;G(t,l,null,u,i)}}for(l in m)u=m[l],l=="children"?g=u:l=="dangerouslySetInnerHTML"?_=u:l=="value"?v=u:l=="checked"?h=u:d&&typeof u!="function"||y[l]===u||G(t,l,u,y[l],i);if(_)d||s&&(_.__html==s.__html||_.__html==t.innerHTML)||(t.innerHTML=_.__html),e.__k=[];else if(s&&(t.innerHTML=""),$e(e.type=="template"?t.content:t,Y(g)?g:[g],e,r,a,b=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,c,o?o[0]:r.__k&&I(r,0),d,f),o!=null)for(l=o.length;l--;)ae(o[l]);d||(l="value",b=="progress"&&v==null?t.removeAttribute("value"):v!=null&&(v!==t[l]||b=="progress"&&!v||b=="option"&&v!=y[l])&&G(t,l,v,y[l],i),l="checked",h!=null&&h!=t[l]&&G(t,l,h,y[l],i))}return t}function le(t,e,r){try{if(typeof t=="function"){var a=typeof t.__u=="function";a&&t.__u(),a&&e==null||(t.__u=t(e))}else t.current=e}catch(i){k.__e(i,r)}}function Le(t,e,r){var a,i;if(k.unmount&&k.unmount(t),(a=t.ref)&&(a.current&&a.current!=t.__e||le(a,null,e)),(a=t.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(o){k.__e(o,e)}a.base=a.__P=null}if(a=t.__k)for(i=0;i<a.length;i++)a[i]&&Le(a[i],e,r||typeof t.type!="function");r||ae(t.__e),t.__c=t.__=t.__e=void 0}function Ue(t,e,r){return this.constructor(t,r)}function We(t,e,r){var a,i,o,c;e==document&&(e=document.documentElement),k.__&&k.__(t,e),i=(a=!1)?null:e.__k,o=[],c=[],se(e,t=e.__k=Ie(U,null,[t]),i||z,z,e.namespaceURI,i?null:e.firstChild?Q.call(e.childNodes):null,o,i?i.__e:e.firstChild,a,c),Ae(o,t,c)}Q=Pe.slice,k={__e:function(t,e,r,a){for(var i,o,c;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),c=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,a||{}),c=i.__d),c)return i.__E=i}catch(d){t=d}throw t}},ke=0,J.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=D({},this.state),typeof t=="function"&&(t=t(D({},r),this.props)),t&&D(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),_e(this))},J.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),_e(this))},J.prototype.render=U,F=[],xe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ee=function(t,e){return t.__v.__b-e.__v.__b},X.__r=0,Se=/(PointerCapture)$|Capture$/i,ie=0,ee=pe(!1),te=pe(!0);var Be=0;function n(t,e,r,a,i,o){e||(e={});var c,d,f=e;if("ref"in f)for(d in f={},e)d=="ref"?c=e[d]:f[d]=e[d];var l={type:t,props:f,key:r,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Be,__i:-1,__u:0,__source:i,__self:o};if(typeof t=="function"&&(c=t.defaultProps))for(d in c)f[d]===void 0&&(f[d]=c[d]);return k.vnode&&k.vnode(l),l}var K,E,Z,fe,re=0,Ne=[],S=k,ue=S.__b,ge=S.__r,ve=S.diffed,ye=S.__c,me=S.unmount,be=S.__;function Oe(t,e){S.__h&&S.__h(E,t,re||e),re=0;var r=E.__H||(E.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({}),r.__[t]}function x(t){return re=1,Ge(Me,t)}function Ge(t,e,r){var a=Oe(K++,2);if(a.t=t,!a.__c&&(a.__=[Me(void 0,e),function(d){var f=a.__N?a.__N[0]:a.__[0],l=a.t(f,d);f!==l&&(a.__N=[l,a.__[1]],a.__c.setState({}))}],a.__c=E,!E.__f)){var i=function(d,f,l){if(!a.__c.__H)return!0;var _=a.__c.__H.__.filter(function(g){return!!g.__c});if(_.every(function(g){return!g.__N}))return!o||o.call(this,d,f,l);var s=a.__c.props!==d;return _.forEach(function(g){if(g.__N){var u=g.__[0];g.__=g.__N,g.__N=void 0,u!==g.__[0]&&(s=!0)}}),o&&o.call(this,d,f,l)||s};E.__f=!0;var o=E.shouldComponentUpdate,c=E.componentWillUpdate;E.componentWillUpdate=function(d,f,l){if(this.__e){var _=o;o=void 0,i(d,f,l),o=_}c&&c.call(this,d,f,l)},E.shouldComponentUpdate=i}return a.__N||a.__}function W(t,e){var r=Oe(K++,3);!S.__s&&qe(r.__H,e)&&(r.__=t,r.u=e,E.__H.__h.push(r))}function Ve(){for(var t;t=Ne.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(q),t.__H.__h.forEach(oe),t.__H.__h=[]}catch(e){t.__H.__h=[],S.__e(e,t.__v)}}S.__b=function(t){E=null,ue&&ue(t)},S.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),be&&be(t,e)},S.__r=function(t){ge&&ge(t),K=0;var e=(E=t.__c).__H;e&&(Z===E?(e.__h=[],E.__h=[],e.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(e.__h.forEach(q),e.__h.forEach(oe),e.__h=[],K=0)),Z=E},S.diffed=function(t){ve&&ve(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ne.push(e)!==1&&fe===S.requestAnimationFrame||((fe=S.requestAnimationFrame)||Je)(Ve)),e.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),Z=E=null},S.__c=function(t,e){e.some(function(r){try{r.__h.forEach(q),r.__h=r.__h.filter(function(a){return!a.__||oe(a)})}catch(a){e.some(function(i){i.__h&&(i.__h=[])}),e=[],S.__e(a,r.__v)}}),ye&&ye(t,e)},S.unmount=function(t){me&&me(t);var e,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(a){try{q(a)}catch(i){e=i}}),r.__H=void 0,e&&S.__e(e,r.__v))};var we=typeof requestAnimationFrame=="function";function Je(t){var e,r=function(){clearTimeout(a),we&&cancelAnimationFrame(e),setTimeout(t)},a=setTimeout(r,35);we&&(e=requestAnimationFrame(r))}function q(t){var e=E,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),E=e}function oe(t){var e=E;t.__c=t.__(),E=e}function qe(t,e){return!t||t.length!==e.length||e.some(function(r,a){return r!==t[a]})}function Me(t,e){return typeof e=="function"?e(t):e}const Xe=({apiUrl:t})=>{const[e,r]=x([]),[a,i]=x(!0),[o,c]=x(null);W(()=>{async function l(){try{const s=await(await fetch(`${t}/pages`)).json();s.success?r(s.data):c(s.error||"Failed to fetch pages")}catch(_){c(String(_))}finally{i(!1)}}l()},[t]);const d=l=>{const _=new Date(l);return _.toLocaleDateString()+" "+_.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},f=e.reduce((l,_)=>l+_.annotation_count,0);return n("div",{children:[n("div",{class:"page-header",children:[n("h1",{class:"page-title",children:"Pages"}),n("p",{class:"page-subtitle",children:"All pages with annotations"})]}),n("div",{class:"stats-grid",children:[n("div",{class:"stat-card",children:[n("div",{class:"stat-label",children:"Total Pages"}),n("div",{class:"stat-value",children:e.length})]}),n("div",{class:"stat-card",children:[n("div",{class:"stat-label",children:"Total Annotations"}),n("div",{class:"stat-value",children:f})]})]}),n("div",{class:"card",children:[n("div",{class:"card-header",children:n("span",{class:"card-title",children:"Annotated Pages"})}),a?n("div",{class:"loading",children:"Loading..."}):o?n("div",{class:"empty-state",children:[n("h3",{children:"Error"}),n("p",{children:o})]}):e.length===0?n("div",{class:"empty-state",children:[n("h3",{children:"No pages yet"}),n("p",{children:"Annotations will appear here once you start adding them."})]}):n("table",{class:"table",children:[n("thead",{children:n("tr",{children:[n("th",{children:"URL"}),n("th",{children:"Annotations"}),n("th",{children:"Last Updated"}),n("th",{})]})}),n("tbody",{children:e.map(l=>n("tr",{children:[n("td",{class:"url-cell",children:n("a",{href:l.url_canonical,target:"_blank",rel:"noopener noreferrer",children:l.url_canonical})}),n("td",{children:n("span",{class:"badge badge-blue",children:l.annotation_count})}),n("td",{children:d(l.latest_annotation_at)}),n("td",{children:n("a",{href:l.url_canonical,target:"_blank",rel:"noopener noreferrer",class:"btn btn-secondary btn-sm",children:"Open"})})]},l.url_canonical))})]})]})]})},Ke=({apiUrl:t})=>{const[e,r]=x([]),[a,i]=x(!0),[o,c]=x(null),[d,f]=x(!1),[l,_]=x(new Set),[s,g]=x(!1),[u,v]=x(""),[h,y]=x(!1),[m,b]=x(!0),[P,$]=x(!1);W(()=>{async function p(){i(!0);try{const C=await(await fetch(`${t}/annotations?includeDeleted=${d}`)).json();C.success?r(C.data):c(C.error||"Failed to fetch annotations")}catch(w){c(String(w))}finally{i(!1)}}p()},[t,d]);const A=async p=>{if(confirm("Are you sure you want to delete this annotation?"))try{const C=await(await fetch(`${t}/annotations/${p}`,{method:"DELETE"})).json();C.success?(r(j=>j.filter(N=>N.id!==p)),_(j=>{const N=new Set(j);return N.delete(p),N})):alert(C.error||"Failed to delete annotation")}catch(w){alert(String(w))}},O=async p=>{try{const C=await(await fetch(`${t}/annotations/${p}/restore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();C.success?r(j=>j.map(N=>N.id===p?{...N,deleted_at:null}:N)):alert(C.error||"Failed to restore annotation")}catch(w){alert(String(w))}},B=p=>{_(w=>{const C=new Set(w);return C.has(p)?C.delete(p):C.add(p),C})},H=()=>{const p=e.filter(w=>!w.deleted_at);l.size===p.length?_(new Set):_(new Set(p.map(w=>w.id)))},M=async()=>{if(l.size!==0){y(!0),g(!0),v(""),$(!1);try{const w=await(await fetch(`${t}/prompts/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({annotation_ids:Array.from(l),enhance_with_ai:m})})).json();w.success?(v(w.data.markdown),$(w.data.enhanced)):(alert(w.error||"Failed to generate prompt"),g(!1))}catch(p){alert(String(p)),g(!1)}finally{y(!1)}}},R=async()=>{y(!0);try{const w=await(await fetch(`${t}/prompts/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({annotation_ids:Array.from(l),markdown:u})})).json();w.success?(alert(`Exported successfully!

Markdown: ${w.data.saved_path_md}
JSON: ${w.data.saved_path_json}`),g(!1),_(new Set)):alert(w.error||"Failed to export prompt")}catch(p){alert(String(p))}finally{y(!1)}},T=async()=>{try{await navigator.clipboard.writeText(u),alert("Copied to clipboard!")}catch(p){alert("Failed to copy: "+String(p))}},L=p=>{const w=new Date(p);return w.toLocaleDateString()+" "+w.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},ce=e.filter(p=>!p.deleted_at),Fe=ce.length>0&&l.size===ce.length;return n("div",{children:[n("div",{class:"page-header",children:[n("h1",{class:"page-title",children:"Annotations"}),n("p",{class:"page-subtitle",children:"Manage all annotations across your prototype"})]}),l.size>0&&n("div",{class:"card",style:{marginBottom:"16px",background:"#eff6ff"},children:n("div",{class:"card-body",style:{padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n("span",{style:{fontWeight:500},children:[l.size," annotation",l.size!==1?"s":""," selected"]}),n("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[n("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px"},children:[n("input",{type:"checkbox",checked:m,onChange:p=>b(p.target.checked)}),"Enhance with AI"]}),n("button",{class:"btn btn-primary",onClick:M,children:"Generate Prompt"}),n("button",{class:"btn btn-secondary",onClick:()=>_(new Set),children:"Clear Selection"})]})]})}),n("div",{class:"card",children:[n("div",{class:"card-header",children:[n("span",{class:"card-title",children:["All Annotations (",e.length,")"]}),n("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px"},children:[n("input",{type:"checkbox",checked:d,onChange:p=>f(p.target.checked)}),"Show deleted"]})]}),a?n("div",{class:"loading",children:"Loading..."}):o?n("div",{class:"empty-state",children:[n("h3",{children:"Error"}),n("p",{children:o})]}):e.length===0?n("div",{class:"empty-state",children:[n("h3",{children:"No annotations yet"}),n("p",{children:"Start annotating your prototype to see them here."})]}):n("table",{class:"table",children:[n("thead",{children:n("tr",{children:[n("th",{style:{width:"40px"},children:n("input",{type:"checkbox",checked:Fe,onChange:H,title:"Select all"})}),n("th",{children:"Title"}),n("th",{children:"Page"}),n("th",{children:"Type"}),n("th",{children:"Created"}),n("th",{children:"Status"}),n("th",{})]})}),n("tbody",{children:e.map(p=>n("tr",{style:{opacity:p.deleted_at?.5:1,background:l.has(p.id)?"#eff6ff":void 0},children:[n("td",{children:n("input",{type:"checkbox",checked:l.has(p.id),onChange:()=>B(p.id),disabled:!!p.deleted_at})}),n("td",{children:[n("div",{style:{fontWeight:500},children:p.title}),p.body&&n("div",{style:{fontSize:"12px",color:"#6b7280",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.body})]}),n("td",{class:"url-cell",children:n("a",{href:p.url_full,target:"_blank",rel:"noopener noreferrer",children:new URL(p.url_canonical).pathname})}),n("td",{children:n("span",{class:`badge ${p.anchor_type==="element"?"badge-blue":"badge-yellow"}`,children:p.anchor_type})}),n("td",{style:{fontSize:"13px",color:"#6b7280"},children:[L(p.created_at),n("div",{style:{fontSize:"11px"},children:["by ",p.created_by]})]}),n("td",{children:p.deleted_at?n("span",{class:"badge badge-red",children:"Deleted"}):n("span",{class:"badge badge-green",children:"Active"})}),n("td",{children:p.deleted_at?n("button",{class:"btn btn-secondary btn-sm",onClick:()=>O(p.id),children:"Restore"}):n("button",{class:"btn btn-secondary btn-sm",onClick:()=>A(p.id),children:"Delete"})})]},p.id))})]})]}),s&&n("div",{class:"modal-overlay",onClick:()=>!h&&g(!1),children:n("div",{class:"modal",onClick:p=>p.stopPropagation(),children:[n("div",{class:"modal-header",children:[n("h2",{class:"modal-title",children:["Generated Prompt",P&&n("span",{class:"badge badge-green",style:{marginLeft:"8px"},children:"AI Enhanced"})]}),n("button",{class:"modal-close",onClick:()=>g(!1),disabled:h,children:"×"})]}),n("div",{class:"modal-body",children:h?n("div",{class:"loading",style:{padding:"40px"},children:["Generating prompt",m?" with AI enhancement":"","..."]}):n("textarea",{class:"prompt-editor",value:u,onInput:p=>v(p.target.value),placeholder:"Generated prompt will appear here..."})}),n("div",{class:"modal-footer",children:[n("button",{class:"btn btn-secondary",onClick:T,disabled:h||!u,children:"Copy to Clipboard"}),n("button",{class:"btn btn-secondary",onClick:()=>g(!1),disabled:h,children:"Cancel"}),n("button",{class:"btn btn-primary",onClick:R,disabled:h||!u,children:"Export to Files"})]})]})})]})},Qe={CREATE:"badge-green",UPDATE:"badge-blue",DELETE:"badge-red",RESTORE:"badge-yellow",EXPORT_PROMPT:"badge-gray"},Ye={CREATE:"+",UPDATE:"~",DELETE:"-",RESTORE:"↺",EXPORT_PROMPT:"↗"},Ze=({apiUrl:t})=>{const[e,r]=x([]),[a,i]=x(!0),[o,c]=x(null),[d,f]=x(0),[l,_]=x(0),s=50;W(()=>{async function h(){i(!0);try{const m=await(await fetch(`${t}/events?limit=${s}&offset=${l}`)).json();m.success?(r(m.data.items),f(m.data.total)):c(m.error||"Failed to fetch events")}catch(y){c(String(y))}finally{i(!1)}}h()},[t,l]);const g=h=>{const y=new Date(h);return y.toLocaleDateString()+" "+y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},u=h=>{const y=new Date(h),b=new Date().getTime()-y.getTime(),P=Math.floor(b/6e4),$=Math.floor(b/36e5),A=Math.floor(b/864e5);return P<1?"just now":P<60?`${P}m ago`:$<24?`${$}h ago`:A<7?`${A}d ago`:g(h)},v=h=>{switch(h.event_type){case"CREATE":return`Created annotation "${h.meta?.title||"untitled"}"`;case"UPDATE":const y=h.diff?Object.keys(h.diff).join(", "):"";return`Updated annotation${y?`: ${y}`:""}`;case"DELETE":return`Deleted annotation "${h.meta?.title||"untitled"}"`;case"RESTORE":return"Restored annotation";case"EXPORT_PROMPT":return`Exported prompt with ${h.meta?.annotation_count||0} annotations`;default:return h.event_type}};return n("div",{children:[n("div",{class:"page-header",children:[n("h1",{class:"page-title",children:"Events"}),n("p",{class:"page-subtitle",children:"Activity timeline and audit log"})]}),n("div",{class:"stats-grid",children:n("div",{class:"stat-card",children:[n("div",{class:"stat-label",children:"Total Events"}),n("div",{class:"stat-value",children:d})]})}),n("div",{class:"card",children:[n("div",{class:"card-header",children:n("span",{class:"card-title",children:"Recent Activity"})}),a?n("div",{class:"loading",children:"Loading..."}):o?n("div",{class:"empty-state",children:[n("h3",{children:"Error"}),n("p",{children:o})]}):e.length===0?n("div",{class:"empty-state",children:[n("h3",{children:"No events yet"}),n("p",{children:"Events will appear here as you interact with annotations."})]}):n(U,{children:[n("div",{class:"card-body",children:n("div",{class:"timeline",children:e.map(h=>n("div",{class:"timeline-item",children:[n("div",{class:"timeline-marker",children:n("span",{style:{fontSize:"14px",fontWeight:"bold"},children:Ye[h.event_type]})}),n("div",{class:"timeline-content",children:[n("div",{class:"timeline-title",children:[n("span",{class:`badge ${Qe[h.event_type]} `,style:{marginRight:"8px"},children:h.event_type}),v(h)]}),n("div",{class:"timeline-meta",children:[u(h.timestamp)," by ",h.actor,h.annotation_id&&n("span",{style:{marginLeft:"8px",color:"#9ca3af"},children:["ID: ",h.annotation_id.slice(0,8),"..."]})]})]})]},h.id))})}),n("div",{class:"pagination",children:[n("div",{class:"pagination-info",children:["Showing ",l+1," - ",Math.min(l+s,d)," of ",d]}),n("div",{class:"pagination-buttons",children:[n("button",{class:"btn btn-secondary btn-sm",disabled:l===0,onClick:()=>_(Math.max(0,l-s)),children:"Previous"}),n("button",{class:"btn btn-secondary btn-sm",disabled:l+s>=d,onClick:()=>_(l+s),children:"Next"})]})]})]})]})]})},et=({apiUrl:t})=>{const[e,r]=x([]),[a,i]=x(!0),[o,c]=x(null),[d,f]=x(!1),[l,_]=x(null);W(()=>{async function v(){try{const y=await(await fetch(`${t}/prompts/exports`)).json();y.success?r(y.data):c(y.error||"Failed to fetch exports")}catch(h){c(String(h))}finally{i(!1)}}v()},[t]);const s=async()=>{f(!0),_(null);try{const h=await(await fetch(`${t}/prompts/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();h.success?_(h.data):alert(h.error||"Failed to generate prompt")}catch(v){alert(String(v))}finally{f(!1)}},g=async()=>{f(!0);try{const h=await(await fetch(`${t}/prompts/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();h.success?(r(y=>[h.data,...y]),_(null),alert(`Exported successfully!

Markdown: ${h.data.saved_path_md}
JSON: ${h.data.saved_path_json}`)):alert(h.error||"Failed to export prompt")}catch(v){alert(String(v))}finally{f(!1)}},u=v=>{const h=new Date(v);return h.toLocaleDateString()+" "+h.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return n("div",{children:[n("div",{class:"page-header",children:[n("h1",{class:"page-title",children:"Prompts"}),n("p",{class:"page-subtitle",children:"Generate and export prompts from annotations"})]}),n("div",{class:"card",style:{marginBottom:"24px"},children:[n("div",{class:"card-header",children:n("span",{class:"card-title",children:"Generate Prompt"})}),n("div",{class:"card-body",children:[n("div",{style:{display:"flex",gap:"8px"},children:[n("button",{class:"btn btn-secondary",onClick:s,disabled:d,children:d?"Generating...":"Preview"}),n("button",{class:"btn btn-primary",onClick:g,disabled:d,children:d?"Exporting...":"Export to Files"})]}),l&&n("div",{style:{marginTop:"20px"},children:[n("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[n("strong",{children:"Preview"}),n("span",{class:"badge badge-gray",children:[l.annotations.length," annotations"]})]}),n("textarea",{style:{width:"100%",height:"400px",padding:"12px",fontFamily:"monospace",fontSize:"13px",border:"1px solid #d1d5db",borderRadius:"6px",resize:"vertical"},value:l.markdown,readOnly:!0})]})]})]}),n("div",{class:"card",children:[n("div",{class:"card-header",children:n("span",{class:"card-title",children:["Export History (",e.length,")"]})}),a?n("div",{class:"loading",children:"Loading..."}):o?n("div",{class:"empty-state",children:[n("h3",{children:"Error"}),n("p",{children:o})]}):e.length===0?n("div",{class:"empty-state",children:[n("h3",{children:"No exports yet"}),n("p",{children:"Exported prompts will appear here."})]}):n("table",{class:"table",children:[n("thead",{children:n("tr",{children:[n("th",{children:"Date"}),n("th",{children:"Actor"}),n("th",{children:"Annotations"}),n("th",{children:"Files"})]})}),n("tbody",{children:e.map(v=>n("tr",{children:[n("td",{children:u(v.created_at)}),n("td",{children:v.actor}),n("td",{children:n("span",{class:"badge badge-blue",children:v.annotation_ids.length})}),n("td",{style:{fontSize:"12px",fontFamily:"monospace"},children:[n("div",{children:v.saved_path_md}),n("div",{children:v.saved_path_json})]})]},v.id))})]})]})]})},tt=()=>n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:[n("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),n("path",{d:"M3 9h18M9 21V9"})]}),nt=()=>n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:n("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),rt=()=>n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:[n("circle",{cx:"12",cy:"12",r:"10"}),n("polyline",{points:"12 6 12 12 16 14"})]}),ot=()=>n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:[n("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),n("polyline",{points:"14 2 14 8 20 8"}),n("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),n("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),n("polyline",{points:"10 9 9 9 8 9"})]});function it(){const t=window.location.pathname.split("/"),e=t.findIndex(r=>r==="dashboard");if(e>0){const r=t.slice(0,e).join("/");return`${window.location.origin}${r}/api`}return`${window.location.origin}/__prototype-annotator/api`}const at=()=>{const[t,e]=x("pages"),r=it();W(()=>{const i=()=>{const o=window.location.hash.slice(1)||"pages";["pages","annotations","events","prompts"].includes(o)&&e(o)};return i(),window.addEventListener("hashchange",i),()=>window.removeEventListener("hashchange",i)},[]);const a=i=>{window.location.hash=i};return n("div",{class:"dashboard",children:[n("aside",{class:"dashboard-sidebar",children:[n("div",{class:"dashboard-logo",children:[n("h1",{children:"Prototype Annotator"}),n("span",{children:"Dashboard"})]}),n("nav",{class:"dashboard-nav",children:[n("a",{href:"#pages",class:`nav-link ${t==="pages"?"active":""}`,onClick:i=>{i.preventDefault(),a("pages")},children:[n(tt,{}),"Pages"]}),n("a",{href:"#annotations",class:`nav-link ${t==="annotations"?"active":""}`,onClick:i=>{i.preventDefault(),a("annotations")},children:[n(nt,{}),"Annotations"]}),n("a",{href:"#events",class:`nav-link ${t==="events"?"active":""}`,onClick:i=>{i.preventDefault(),a("events")},children:[n(rt,{}),"Events"]}),n("a",{href:"#prompts",class:`nav-link ${t==="prompts"?"active":""}`,onClick:i=>{i.preventDefault(),a("prompts")},children:[n(ot,{}),"Prompts"]})]})]}),n("main",{class:"dashboard-main",children:[t==="pages"&&n(Xe,{apiUrl:r}),t==="annotations"&&n(Ke,{apiUrl:r}),t==="events"&&n(Ze,{apiUrl:r}),t==="prompts"&&n(et,{apiUrl:r})]})]})};We(n(at,{}),document.getElementById("app"));
//# sourceMappingURL=index-9pU35KgB.js.map
